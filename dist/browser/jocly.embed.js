"use strict";function receiveMessage(e){function a(a){window.parent.postMessage({joclyEmbeddedGameId:gameId,replyId:e.data.replyId,message:a},"*")}if(console.info("embed receives message",e.data),(e.origin||e.originalEvent.origin)==new URL(window.location).origin){var n=e.data.message;switch(n.type){case"init":gameId=n.id;var t=document.getElementById("area");Jocly.createInternalGame(n.gameName).then(function(e){function n(){e.AttachElement(t).then(function(){e.GameInitView(),e.DisplayBoard(),a()})}gGame=e,e.AddListener(Listen),"complete"===document.readyState||"loaded"===document.readyState||"interactive"===document.readyState?n():window.addEventListener("DOMContentLoaded",function(){n()})});break;case"humanTurn":gGame.HumanTurn();break;case"machineTurn":gGame.StartMachine(n.options);break;case"getFinished":var i=gGame.GetFinished();a({finished:!!i,winner:i});break;case"getMoveString":a(new(gGame.GetMoveClass())(n.move).ToString())}}}function Listen(e){switch(e.type){case"human-move":gGame.ApplyMove(e.move);var a=gGame.GetFinished();a||gGame.InvertWho(),gGame.DisplayBoard(),Object.assign(e,{finished:!!a,winner:a});break;case"machine-move":var n=e.result.move;return delete e.result.move,void gGame.PlayMove(n).then(function(){var a=gGame.GetFinished();a||gGame.InvertWho(),gGame.DisplayBoard(),window.parent.postMessage({joclyEmbeddedGameId:gameId,message:{type:"machine-move",moveData:e.result,move:n,finished:!!a,winner:a}},"*")})}window.parent.postMessage({joclyEmbeddedGameId:gameId,message:e},"*")}var gameId,gGame;window.addEventListener("message",receiveMessage,!1);